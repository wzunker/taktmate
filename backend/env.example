# TaktMate Environment Configuration Template
# Copy this file to .env and fill in your actual values

# =============================================================================
# Azure AD B2C Configuration
# =============================================================================

# Azure AD B2C Tenant Information
AZURE_AD_B2C_TENANT_NAME=taktmate
AZURE_AD_B2C_TENANT_ID=your-tenant-id-guid-here
AZURE_AD_B2C_DOMAIN=taktmate.b2clogin.com

# Application Registration Details (from Azure AD B2C App Registration)
AZURE_AD_B2C_CLIENT_ID=your-client-id-here
AZURE_AD_B2C_CLIENT_SECRET=your-client-secret-here

# User Flows/Policies
AZURE_AD_B2C_SIGN_UP_SIGN_IN_POLICY=B2C_1_signupsignin1
AZURE_AD_B2C_PASSWORD_RESET_POLICY=B2C_1_passwordreset1
AZURE_AD_B2C_PROFILE_EDIT_POLICY=B2C_1_profileedit1

# Custom Policies (Optional - set to true to use custom policies instead of user flows)
AZURE_AD_B2C_USE_CUSTOM_POLICIES=false
AZURE_AD_B2C_CUSTOM_POLICY_SIGNUP_SIGNIN=B2C_1A_TaktMate_SignUpOrSignIn
AZURE_AD_B2C_CUSTOM_POLICY_PASSWORD_RESET=B2C_1A_TaktMate_PasswordReset
AZURE_AD_B2C_CUSTOM_POLICY_PROFILE_EDIT=B2C_1A_TaktMate_ProfileEdit

# Token and Scope Configuration
AZURE_AD_B2C_SCOPE=openid profile email

# Redirect URLs (Environment-specific)
# Development
AZURE_AD_B2C_REDIRECT_URI=http://localhost:3000/auth/callback
AZURE_AD_B2C_POST_LOGOUT_REDIRECT_URI=http://localhost:3000

# Production (uncomment and update for production)
# AZURE_AD_B2C_REDIRECT_URI=https://app.taktconnect.com/auth/callback
# AZURE_AD_B2C_POST_LOGOUT_REDIRECT_URI=https://app.taktconnect.com

# =============================================================================
# Application URLs
# =============================================================================

# Frontend URL (where React app is hosted)
FRONTEND_URL=http://localhost:3000

# Backend URL (where Express API is hosted)
BACKEND_URL=http://localhost:3001

# =============================================================================
# Azure OpenAI Configuration
# =============================================================================

# Azure OpenAI Service Configuration
AZURE_OPENAI_API_KEY=your-azure-openai-api-key
AZURE_OPENAI_ENDPOINT=https://your-resource-name.openai.azure.com/
AZURE_OPENAI_API_VERSION=2024-02-15-preview
AZURE_OPENAI_DEPLOYMENT_NAME=gpt-4

# =============================================================================
# Security Configuration
# =============================================================================

# JWT Secret for additional token signing (if needed)
JWT_SECRET=your-super-secret-jwt-key-change-in-production

# Session Configuration
SESSION_SECRET=your-session-secret-change-in-production

# Cookie Encryption (for Azure AD B2C passport strategy)
COOKIE_ENCRYPTION_KEY=your-32-character-encryption-key-here
COOKIE_ENCRYPTION_IV=your-16-character-iv-here

# =============================================================================
# Azure Application Insights (Task 3.0)
# =============================================================================

# Application Insights Configuration (will be added in Task 3.0)
# APPINSIGHTS_INSTRUMENTATIONKEY=your-instrumentation-key
# APPINSIGHTS_CONNECTION_STRING=your-connection-string

# =============================================================================
# Email Service Configuration (External Provider)
# =============================================================================

# SendGrid Configuration (recommended)
SENDGRID_API_KEY=your-sendgrid-api-key
SENDGRID_FROM_EMAIL=noreply@taktconnect.com
SENDGRID_FROM_NAME=TaktMate

# Alternative: SMTP Configuration
# EMAIL_SERVICE=smtp
# SMTP_HOST=smtp.gmail.com
# SMTP_PORT=587
# SMTP_SECURE=false
# SMTP_USER=your-email@gmail.com
# SMTP_PASSWORD=your-app-password

# =============================================================================
# Azure Key Vault Configuration (Production)
# =============================================================================

# Azure Key Vault (for production secret management)
# AZURE_KEY_VAULT_URL=https://your-keyvault-name.vault.azure.net/
# AZURE_CLIENT_ID=your-service-principal-client-id
# AZURE_CLIENT_SECRET=your-service-principal-secret
# AZURE_TENANT_ID=your-azure-tenant-id

# =============================================================================
# Development/Debug Configuration
# =============================================================================

# Environment
NODE_ENV=development

# Logging Level
LOG_LEVEL=debug

# Enable Debug Logging for Azure AD B2C
# DEBUG=passport:*

# CORS Configuration
CORS_ORIGIN=http://localhost:3000

# =============================================================================
# Production-Only Configuration
# =============================================================================

# Port Configuration (usually set by hosting platform)
PORT=3001

# SSL/TLS Configuration (for production)
# FORCE_HTTPS=true

# Rate Limiting
# RATE_LIMIT_WINDOW_MS=900000
# RATE_LIMIT_MAX_REQUESTS=100

# =============================================================================
# OAuth Provider Configuration (for Azure AD B2C Identity Providers)
# =============================================================================

# Google OAuth (for Azure AD B2C Google Identity Provider)
# These are configured in Google Cloud Console and then added to Azure AD B2C
# GOOGLE_CLIENT_ID=your-google-client-id
# GOOGLE_CLIENT_SECRET=your-google-client-secret

# Microsoft OAuth (for Azure AD B2C Microsoft Identity Provider)  
# These are configured in Azure AD App Registration and then added to Azure AD B2C
# MICROSOFT_CLIENT_ID=your-microsoft-client-id
# MICROSOFT_CLIENT_SECRET=your-microsoft-client-secret

# =============================================================================
# Database Configuration (Not needed with Azure AD B2C)
# =============================================================================

# Note: With Azure AD B2C handling user management, we don't need a database
# for user accounts. Uncomment below only if you need application-specific data storage.

# Azure SQL Database Configuration
# DB_SERVER=your-server-name.database.windows.net
# DB_DATABASE=taktmate
# DB_USERNAME=your-username
# DB_PASSWORD=your-password
# DB_PORT=1433
# DB_ENCRYPT=true
# DB_TRUST_SERVER_CERTIFICATE=false

# =============================================================================
# File Storage Configuration (Future Enhancement)
# =============================================================================

# Azure Blob Storage (for future file persistence)
# AZURE_STORAGE_ACCOUNT_NAME=your-storage-account
# AZURE_STORAGE_ACCOUNT_KEY=your-storage-key
# AZURE_STORAGE_CONTAINER_NAME=taktmate-files

# =============================================================================
# Instructions
# =============================================================================

# 1. Copy this file to .env in the same directory
# 2. Fill in your actual values (remove "your-" prefixes)
# 3. Never commit .env file to version control
# 4. For production, use Azure Key Vault or App Service Configuration
# 5. See AZURE_AD_B2C_SETUP.md for detailed setup instructions

# =============================================================================
# AZURE APPLICATION INSIGHTS CONFIGURATION
# Comprehensive monitoring, logging, and analytics for TaktMate backend
# =============================================================================

# Application Insights Connection String (REQUIRED - preferred method)
# Get from Azure Portal > Application Insights > Overview > Connection String
APPLICATIONINSIGHTS_CONNECTION_STRING=InstrumentationKey=your-instrumentation-key;IngestionEndpoint=https://your-region.in.applicationinsights.azure.com/;LiveEndpoint=https://your-region.livediagnostics.monitor.azure.com/

# Alternative: Instrumentation Key (legacy method - use connection string instead)
# APPINSIGHTS_INSTRUMENTATIONKEY=your-instrumentation-key

# Cloud role configuration for service map and distributed tracing
APPINSIGHTS_CLOUD_ROLE=taktmate-backend
APPINSIGHTS_CLOUD_ROLE_INSTANCE=taktmate-backend-instance

# Sampling configuration for cost optimization
# Development: 100%, Staging: 50%, Production: 10-20%
APPINSIGHTS_SAMPLING_PERCENTAGE=100
APPINSIGHTS_MAX_SAMPLES_PER_SECOND=20

# Auto-collection settings - control what data is automatically collected
APPINSIGHTS_AUTO_COLLECT_REQUESTS=true
APPINSIGHTS_AUTO_COLLECT_PERFORMANCE=true
APPINSIGHTS_AUTO_COLLECT_EXCEPTIONS=true
APPINSIGHTS_AUTO_COLLECT_DEPENDENCIES=true
APPINSIGHTS_AUTO_COLLECT_CONSOLE=true
APPINSIGHTS_AUTO_COLLECT_HEARTBEAT=true
APPINSIGHTS_PREAGGREGATE_METRICS=true

# Live metrics and streaming configuration
APPINSIGHTS_ENABLE_LIVE_METRICS=true
APPINSIGHTS_SEND_LIVE_METRICS=true
# Optional: API key for authenticated live metrics (production recommended)
# APPINSIGHTS_LIVE_METRICS_API_KEY=your-live-metrics-api-key

# Web instrumentation and correlation
APPINSIGHTS_ENABLE_WEB_INSTRUMENTATION=true
APPINSIGHTS_ENABLE_DISTRIBUTED_TRACING=true
APPINSIGHTS_ENABLE_AUTO_CORRELATION=true
# Enable for detailed request/response analysis (may impact performance)
APPINSIGHTS_ENABLE_REQUEST_RESPONSE_HEADERS=false

# Performance and reliability settings
APPINSIGHTS_USE_DISK_RETRY_CACHING=true
APPINSIGHTS_RESEND_INTERVAL=60000
APPINSIGHTS_MAX_BYTES_ON_DISK=52428800

# Privacy and compliance settings
APPINSIGHTS_DISABLE_EXTENDED_METRICS=false

# TaktMate-specific telemetry settings
APPINSIGHTS_ENABLE_CUSTOM_TELEMETRY=true
APPINSIGHTS_ENABLE_USER_TRACKING=true
APPINSIGHTS_ENABLE_BUSINESS_METRICS=true
APPINSIGHTS_ENABLE_SECURITY_MONITORING=true

# Debug and development settings (set to false in production)
APPINSIGHTS_DEBUG_LOGGING=false
APPINSIGHTS_VERBOSE_LOGGING=false

# Azure resource information for tagging and organization
AZURE_SUBSCRIPTION_ID=your-subscription-id
AZURE_RESOURCE_GROUP=taktmate-resources
AZURE_REGION=eastus

# Performance Monitoring Configuration
APPINSIGHTS_PERFORMANCE_MONITORING_ENABLED=true
APPINSIGHTS_PERFORMANCE_MONITORING_INTERVAL=60000
APPINSIGHTS_SYSTEM_METRICS_ENABLED=true
APPINSIGHTS_REQUEST_PERFORMANCE_ENABLED=true
APPINSIGHTS_DEPENDENCY_TRACKING_ENABLED=true
APPINSIGHTS_OPERATION_TRACKING_ENABLED=true
APPINSIGHTS_RESOURCE_MONITORING_ENABLED=true
APPINSIGHTS_STARTUP_TRACKING_ENABLED=true

# Performance Monitoring Thresholds
APPINSIGHTS_SLOW_REQUEST_THRESHOLD=1000
APPINSIGHTS_SLOW_DEPENDENCY_THRESHOLD=5000
APPINSIGHTS_HIGH_MEMORY_THRESHOLD=80
APPINSIGHTS_HIGH_CPU_THRESHOLD=80

# Performance Monitoring Sampling
APPINSIGHTS_PERFORMANCE_SAMPLING_PERCENTAGE=100
APPINSIGHTS_SYSTEM_METRICS_SAMPLING_PERCENTAGE=10

# Error Tracking and Exception Logging Configuration
APPINSIGHTS_ERROR_TRACKING_ENABLED=true
APPINSIGHTS_UNHANDLED_EXCEPTION_TRACKING=true
APPINSIGHTS_HTTP_ERROR_TRACKING=true
APPINSIGHTS_VALIDATION_ERROR_TRACKING=true
APPINSIGHTS_AUTH_ERROR_TRACKING=true
APPINSIGHTS_EXTERNAL_SERVICE_ERROR_TRACKING=true
APPINSIGHTS_ERROR_CORRELATION_ENABLED=true

# Error Tracking Thresholds and Classification
APPINSIGHTS_CRITICAL_ERROR_THRESHOLD=500
APPINSIGHTS_WARNING_ERROR_THRESHOLD=400
APPINSIGHTS_HIGH_MEMORY_ERROR_THRESHOLD=90
APPINSIGHTS_ERROR_STACK_TRACE_ENABLED=true
APPINSIGHTS_ERROR_CONTEXT_CAPTURE=true

# Error Tracking Sampling and Filtering
APPINSIGHTS_ERROR_SAMPLING_PERCENTAGE=100
APPINSIGHTS_CRITICAL_ERROR_SAMPLING_PERCENTAGE=100
APPINSIGHTS_WARNING_ERROR_SAMPLING_PERCENTAGE=50
APPINSIGHTS_INFO_ERROR_SAMPLING_PERCENTAGE=10

# Security and Privacy for Error Tracking
APPINSIGHTS_ERROR_PII_FILTERING=true
APPINSIGHTS_ERROR_SENSITIVE_DATA_MASKING=true
APPINSIGHTS_ERROR_USER_DATA_ANONYMIZATION=false

# Application deployment information
APP_VERSION=2.0.0
DEPLOYMENT_ID=deploy-timestamp

# Alert Configuration
APPINSIGHTS_NAME=your-app-insights-name

# Alert Notification Configuration
ALERT_EMAIL_RECIPIENTS=[{"name":"DevOps Team","emailAddress":"devops@taktmate.com"},{"name":"Engineering Team","emailAddress":"engineering@taktmate.com"}]
ALERT_SMS_RECIPIENTS=[]
ALERT_WEBHOOK_URL=https://hooks.slack.com/services/your/slack/webhook
ALERT_LOGIC_APP_RESOURCE_ID=

# Alert Thresholds Configuration
ALERT_ERROR_RATE_THRESHOLD=5
ALERT_RESPONSE_TIME_THRESHOLD=5000
ALERT_MEMORY_USAGE_THRESHOLD=85
ALERT_CPU_USAGE_THRESHOLD=90
ALERT_AVAILABILITY_THRESHOLD=95

# Alert Evaluation Configuration
ALERT_EVALUATION_FREQUENCY_CRITICAL=PT1M
ALERT_EVALUATION_FREQUENCY_WARNING=PT5M
ALERT_EVALUATION_FREQUENCY_INFO=PT10M
ALERT_WINDOW_SIZE_CRITICAL=PT5M
ALERT_WINDOW_SIZE_WARNING=PT15M
ALERT_WINDOW_SIZE_INFO=PT30M

# Alert Feature Toggles
ALERT_ENABLE_CRITICAL_ALERTS=true
ALERT_ENABLE_PERFORMANCE_ALERTS=true
ALERT_ENABLE_BUSINESS_ALERTS=true
ALERT_ENABLE_SMS_NOTIFICATIONS=false
ALERT_ENABLE_WEBHOOK_NOTIFICATIONS=true

# =============================================================================
# SECURITY CONFIGURATION
# =============================================================================

# Rate Limiting Settings
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=1000
API_RATE_LIMIT_MAX=200
UPLOAD_RATE_LIMIT_MAX=50
AUTH_RATE_LIMIT_MAX=100

# CORS Settings
ENABLE_CORS=true
CORS_ORIGIN=http://localhost:3000,https://app.taktconnect.com
CORS_CREDENTIALS=true

# Security Headers
ENABLE_HELMET=true
HSTS_MAX_AGE=31536000
CSP_ENABLED=true

# Request Size Limits
MAX_REQUEST_SIZE=10mb
MAX_FILE_SIZE=5mb

# =============================================================================
# PERFORMANCE AND DEBUGGING
# =============================================================================

# Debug Settings
DEBUG_PROMPTS=true
DEBUG_JWT=false
DEBUG_AUTH=false
DEBUG_SECURITY=false

# Performance Settings
JWT_CACHE_TTL=86400000
JWKS_CACHE_TTL=86400000
REQUEST_TIMEOUT=30000

# Logging Settings
LOG_LEVEL=info
ENABLE_ACCESS_LOGS=true
ENABLE_ERROR_LOGS=true
ENABLE_SECURITY_LOGS=true

# Health Check Settings
HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_TIMEOUT=5000
