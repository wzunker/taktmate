# TaktMate Backend Environment Configuration - STAGING
# This file should be used as a template for staging deployment
# Actual secrets should be stored in Azure Key Vault

# ============================================================================
# AZURE CONFIGURATION
# ============================================================================

# Azure Key Vault Configuration
AZURE_KEY_VAULT_NAME=taktmate-kv-staging
AZURE_KEY_VAULT_URL=https://taktmate-kv-staging.vault.azure.net/

# Azure Application Insights Configuration
APPINSIGHTS_CONNECTION_STRING=@Microsoft.KeyVault(VaultName=taktmate-kv-staging;SecretName=AppInsights-ConnectionString)
APPINSIGHTS_INSTRUMENTATION_KEY=@Microsoft.KeyVault(VaultName=taktmate-kv-staging;SecretName=AppInsights-InstrumentationKey)
APPLICATIONINSIGHTS_CONNECTION_STRING=@Microsoft.KeyVault(VaultName=taktmate-kv-staging;SecretName=AppInsights-ConnectionString)

# ============================================================================
# AZURE AD B2C CONFIGURATION
# ============================================================================

# Azure AD B2C Tenant Configuration
AZURE_AD_B2C_TENANT_NAME=taktmate-staging
AZURE_AD_B2C_TENANT_ID=@Microsoft.KeyVault(VaultName=taktmate-kv-staging;SecretName=Azure-AD-B2C-Tenant-ID)
AZURE_AD_B2C_CLIENT_ID=@Microsoft.KeyVault(VaultName=taktmate-kv-staging;SecretName=Azure-AD-B2C-Client-ID)
AZURE_AD_B2C_CLIENT_SECRET=@Microsoft.KeyVault(VaultName=taktmate-kv-staging;SecretName=Azure-AD-B2C-Client-Secret)

# Azure AD B2C Endpoints
AZURE_AD_B2C_AUTHORITY=https://taktmate-staging.b2clogin.com/taktmate-staging.onmicrosoft.com/B2C_1_SignUpSignIn
AZURE_AD_B2C_KNOWN_AUTHORITY=taktmate-staging.b2clogin.com
AZURE_AD_B2C_DISCOVERY_ENDPOINT=https://taktmate-staging.b2clogin.com/taktmate-staging.onmicrosoft.com/B2C_1_SignUpSignIn/v2.0/.well-known/openid_configuration

# Azure AD B2C Policies
AZURE_AD_B2C_SIGNUP_SIGNIN_POLICY=B2C_1_SignUpSignIn
AZURE_AD_B2C_EDIT_PROFILE_POLICY=B2C_1_EditProfile
AZURE_AD_B2C_RESET_PASSWORD_POLICY=B2C_1_ResetPassword

# Azure AD B2C Scopes
AZURE_AD_B2C_SCOPE=https://taktmate-staging.onmicrosoft.com/api/read

# ============================================================================
# EXTERNAL SERVICE CONFIGURATION
# ============================================================================

# OpenAI Configuration
OPENAI_API_KEY=@Microsoft.KeyVault(VaultName=taktmate-kv-staging;SecretName=OpenAI-API-Key)
OPENAI_MODEL=gpt-4
OPENAI_MAX_TOKENS=2048
OPENAI_TEMPERATURE=0.7
OPENAI_TIMEOUT=30000

# ============================================================================
# APPLICATION CONFIGURATION
# ============================================================================

# Server Configuration
NODE_ENV=staging
PORT=3001
HOST=0.0.0.0

# CORS Configuration
CORS_ORIGIN=https://staging.taktmate.com
CORS_CREDENTIALS=true

# Security Configuration
JWT_SECRET=@Microsoft.KeyVault(VaultName=taktmate-kv-staging;SecretName=JWT-Secret)
SESSION_SECRET=@Microsoft.KeyVault(VaultName=taktmate-kv-staging;SecretName=Session-Secret)

# File Upload Configuration
MAX_FILE_SIZE=5242880
ALLOWED_FILE_TYPES=text/csv,application/vnd.ms-excel
UPLOAD_TIMEOUT=30000

# ============================================================================
# LOGGING AND MONITORING CONFIGURATION
# ============================================================================

# Logging Configuration
LOG_LEVEL=info
LOG_FORMAT=json
LOG_FILE_ENABLED=true
LOG_CONSOLE_ENABLED=true

# Application Insights Configuration
APPINSIGHTS_ENABLE_AUTO_COLLECT_CONSOLE=true
APPINSIGHTS_ENABLE_AUTO_COLLECT_EXCEPTIONS=true
APPINSIGHTS_ENABLE_AUTO_COLLECT_REQUESTS=true
APPINSIGHTS_ENABLE_AUTO_COLLECT_PERFORMANCE=true
APPINSIGHTS_ENABLE_AUTO_COLLECT_DEPENDENCIES=true
APPINSIGHTS_ENABLE_AUTO_COLLECT_HEARTBEAT=true
APPINSIGHTS_ENABLE_WEB_INSTRUMENTATION=false
APPINSIGHTS_ENABLE_LIVE_METRICS=true
APPINSIGHTS_ENABLE_DISK_CACHING=true
APPINSIGHTS_SAMPLING_PERCENTAGE=100

# Custom Telemetry Configuration
ENABLE_CUSTOM_TELEMETRY=true
ENABLE_CSV_TELEMETRY=true
ENABLE_PERFORMANCE_MONITORING=true
ENABLE_ERROR_TRACKING=true
ENABLE_RESOURCE_MONITORING=true

# Azure Monitor Configuration
AZURE_MONITOR_RESOURCE_GROUP=taktmate-staging-rg
AZURE_MONITOR_RESOURCE_NAME=taktmate-api-staging
AZURE_MONITOR_LOCATION=eastus

# ============================================================================
# PERFORMANCE AND SCALING CONFIGURATION
# ============================================================================

# Performance Configuration
REQUEST_TIMEOUT=30000
KEEP_ALIVE_TIMEOUT=5000
HEADERS_TIMEOUT=60000

# Rate Limiting Configuration
RATE_LIMIT_WINDOW=900000
RATE_LIMIT_MAX=150
RATE_LIMIT_SKIP_SUCCESS_REQUESTS=false

# Memory Management
NODE_OPTIONS=--max-old-space-size=1024

# ============================================================================
# FEATURE FLAGS
# ============================================================================

# Feature Toggle Configuration
FEATURE_ADVANCED_ANALYTICS=true
FEATURE_BULK_OPERATIONS=true
FEATURE_EXPORT_FUNCTIONALITY=true
FEATURE_REAL_TIME_COLLABORATION=true

# ============================================================================
# STAGING SPECIFIC CONFIGURATION
# ============================================================================

# Staging-specific configuration
DEBUG=false
TRUST_PROXY=true
SECURE_COOKIES=true

# SSL/TLS Configuration
FORCE_HTTPS=true
HSTS_MAX_AGE=31536000
HSTS_INCLUDE_SUBDOMAINS=false

# Staging Monitoring
ENABLE_HEALTH_CHECKS=true
HEALTH_CHECK_ENDPOINT=/api/health
ENABLE_METRICS_ENDPOINT=true
METRICS_ENDPOINT=/api/metrics

# Staging Error Handling
SEND_ERROR_DETAILS=true
LOG_STACK_TRACES=true
ENABLE_ERROR_REPORTING=true

# Development Tools (enabled in staging)
ENABLE_DEBUG_ROUTES=true
ENABLE_ADMIN_PANEL=true
